# Your First SSR Page

**Goal:** Get a server-rendered React page working in under 5 minutes.

**Prerequisites:** A working NestJS app. If you don't have one:
```bash
npx @nestjs/cli new my-ssr-app && cd my-ssr-app
```

## Quick Start

### 1. Install Dependencies (30 seconds)

```bash
npm install @nestjs-ssr/react react react-dom vite @vitejs/plugin-react
npm install -D concurrently
```

### 2. Create Vite Config (1 minute)

Create `vite.config.ts`:
```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { viewRegistryPlugin } from '@nestjs-ssr/react/vite';

export default defineConfig({
  plugins: [react(), viewRegistryPlugin()],
});
```

### 3. Setup NestJS Module (30 seconds)

In `src/app.module.ts`:
```typescript
import { RenderModule } from '@nestjs-ssr/react';

@Module({
  imports: [RenderModule.register()],  // Add this line
  // ... rest of your module
})
```

### 4. Create Your View (1 minute)

Create `src/views/hello.tsx`:
```typescript
import type { PageProps } from '@nestjs-ssr/react';

export default function Hello({ data }: PageProps<{ name: string }>) {
  return (
    <html>
      <head>
        <title>Hello SSR</title>
      </head>
      <body>
        <h1>Hello {data.name}!</h1>
        <p>This page was server-rendered by NestJS.</p>
      </body>
    </html>
  );
}
```

### 5. Add Controller Route (30 seconds)

In `src/app.controller.ts`:
```typescript
import { Render } from '@nestjs-ssr/react';

@Controller()
export class AppController {
  @Get()
  @Render('views/hello')
  hello() {
    return { name: 'World' };
  }
}
```

### 6. Create Entry Files (2 minutes)

Create `src/view/entry-client.tsx`:
```typescript
import { StrictMode } from 'react';
import { hydrateRoot } from 'react-dom/client';
import { viewRegistry } from './view-registry.generated';

const viewPath = window.__COMPONENT_PATH__;
const ViewComponent = viewRegistry[viewPath];

hydrateRoot(
  document.getElementById('root')!,
  <StrictMode>
    <ViewComponent
      data={window.__INITIAL_STATE__}
      context={window.__CONTEXT__}
    />
  </StrictMode>
);
```

Create `src/view/entry-server.tsx`:
```typescript
import { viewRegistry } from './view-registry.generated';

export function render(viewPath: string, props: any, context: any) {
  const ViewComponent = viewRegistry[viewPath];
  return <ViewComponent data={props} context={context} />;
}
```

Create `src/view/view-registry.generated.ts`:
```typescript
// Auto-generated by Vite plugin
export const viewRegistry: Record<string, React.ComponentType<any>> = {};
```

### 7. Update package.json Scripts (30 seconds)

```json
{
  "scripts": {
    "dev": "concurrently \"vite\" \"nest start --watch\"",
    "build": "vite build --outDir dist/client && vite build --ssr src/view/entry-server.tsx --outDir dist/server && nest build"
  }
}
```

### 8. Run It!

```bash
npm run dev
```

Visit **http://localhost:3000** - you should see your server-rendered page!

## What's Happening?

1. **Request hits NestJS** ‚Üí Controller method runs
2. **`@Render` decorator** ‚Üí Intercepts response
3. **React component renders** ‚Üí On the server
4. **HTML sent to browser** ‚Üí With embedded data
5. **React hydrates** ‚Üí Makes it interactive

## Make It Interactive

Add a button to `src/views/hello.tsx`:

```typescript
import { useState } from 'react';

export default function Hello({ data }: PageProps<{ name: string }>) {
  const [count, setCount] = useState(0);

  return (
    <html>
      <head><title>Hello SSR</title></head>
      <body>
        <h1>Hello {data.name}!</h1>
        <p>Clicked {count} times</p>
        <button onClick={() => setCount(count + 1)}>Click me</button>
      </body>
    </html>
  );
}
```

Save the file. **The page updates instantly** (HMR). Click the button‚Äîit works! This is SSR + client-side React working together.

## Next Steps

- ‚úÖ **You just built your first SSR page!**
- üìñ [Add Forms and Data Fetching](./forms-and-data.md)
- üèóÔ∏è [Organize Views by Module](../ARCHITECTURE.md#clean-architecture)
- üöÄ [Deploy to Production](./production-deployment.md)

## Troubleshooting

**"View not found"** ‚Üí Check the file is at `src/views/hello.tsx` and restart dev server.

**"Cannot find module '@nestjs-ssr/react'"** ‚Üí Run `npm install @nestjs-ssr/react`.

**"Port 3000 already in use"** ‚Üí Stop other processes or change the port in `main.ts`.

---

**Built your first page?** Now learn how to [handle forms and fetch data ‚Üí](./forms-and-data.md)
